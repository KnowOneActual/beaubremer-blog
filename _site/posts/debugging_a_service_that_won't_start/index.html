<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>When a Service Plays Dead: A Sysadmin&#39;s Debugging Guide | Beau Bremer&#39;s | Blog</title>
    <meta name="description" content="A step-by-step guide to troubleshooting a Linux service that won&#39;t start, using a real-world example with a stubborn Tor Onion Service." />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Space+Grotesk:wght@400;700&display=swap" as="style" crossorigin="anonymous" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet" crossorigin="anonymous" />
    
<link rel="icon" type="image/svg+xml" href="/img/favicon/favicon.svg" />
<link rel="icon" type="image/webp" href="/img/favicon/favicon-32x32.webp" sizes="32x32">
<link rel="icon" type="image/webp" href="/img/favicon/favicon-96x96.webp" sizes="96x96">
<link rel="icon" type="image/png" href="/img/favicon/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/png" href="/img/favicon/favicon-32x32.png" sizes="32x32" />
<link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-touch-icon.png" />
<link rel="manifest" href="/img/favicon/site.webmanifest" />
<link rel="shortcut icon" href="/img/favicon/favicon.ico" />
<link rel="stylesheet" href="/assets/css/lite-yt-embed.css" />
</head>
<body class="bg-gray-950 text-white scroll-smooth flex flex-col min-h-screen">

    <header class="py-6 px-6 max-w-3xl mx-auto w-full">
        <div class="flex justify-between items-center">
            <div>
                <a href="/" class="text-2xl font-bold text-white hover:text-fuchsia-400 transition-colors">Beau Bremer&#39;s | Blog</a>
            </div>
            <nav>
              
                <a href="/" class="text-gray-300 hover:text-white transition-colors">← Back to Blog Home</a>
              
            </nav>
        </div>
    </header>

    <main class="max-w-3xl mx-auto py-12 px-6 flex-grow w-full">
        <div class="prose prose-invert lg:prose-xl max-w-none">
            <article>
    <header>
        <h1 class="text-5xl font-extrabold text-fuchsia-400 mb-4">When a Service Plays Dead: A Sysadmin&#39;s Debugging Guide</h1>
        
            <p class="text-gray-400">
                <time datetime="2025-09-02T00:00:00.000Z">September 02, 2025</time>
            </p>
        
        
        
        
            <div class="mt-4">
                <span class="text-gray-400">Tagged in:</span>
                
                    
                
                    
                        <a href="/tags/linux/" class="inline-block bg-gray-800 text-fuchsia-300 rounded-full px-3 py-1 text-sm font-semibold ml-2 hover:bg-gray-700 transition-colors">#linux</a>
                    
                
                    
                        <a href="/tags/sysadmin/" class="inline-block bg-gray-800 text-fuchsia-300 rounded-full px-3 py-1 text-sm font-semibold ml-2 hover:bg-gray-700 transition-colors">#sysadmin</a>
                    
                
                    
                        <a href="/tags/debugging/" class="inline-block bg-gray-800 text-fuchsia-300 rounded-full px-3 py-1 text-sm font-semibold ml-2 hover:bg-gray-700 transition-colors">#debugging</a>
                    
                
                    
                        <a href="/tags/troubleshooting/" class="inline-block bg-gray-800 text-fuchsia-300 rounded-full px-3 py-1 text-sm font-semibold ml-2 hover:bg-gray-700 transition-colors">#troubleshooting</a>
                    
                
            </div>
        
    </header>
    
    <hr class="border-gray-700 my-8">

    <h2>A Sysadmin's Tale: Debugging a Service That Won't Start</h2>
<p>Every so often in server administration, you run into a problem that defies the usual solutions. A service that should be running simply isn't, and the quick fixes don't work. A recent troubleshooting session with a self-hosted Tor Onion Service served as a great reminder of some valuable lessons in persistence and diagnostics.</p>
<p>While the context here is a Tor service, the step-by-step process of elimination is a universal guide to debugging almost any misbehaving service on a Linux server.</p>
<hr>
<h3>The Problem: A Service Playing Dead</h3>
<p>The initial symptom was simple: the onion site was down. After connecting to the server, the first command in any admin's toolkit is <code>systemctl status</code>.</p>
<pre><code class="language-bash">sudo systemctl status tor
</code></pre>
<p>The output holds the first major clue: <strong><code>Active: active (exited)</code></strong>. For a service that's supposed to run continuously, this is a red flag. It means the service started, did something, and then immediately shut down without an obvious error. This is far trickier to debug than a simple crash.</p>
<hr>
<h3>The Diagnostic Journey: Peeling the Onion</h3>
<p>When the main status is unhelpful, it's time to dig deeper. Here's a reliable path to follow, moving from the most general to the most specific tests.</p>
<h4>1. Check the System Logs (<code>journalctl</code>)</h4>
<p>The next logical step is to check the system's journal for the service. The <code>-e</code> flag jumps you to the end of the log, which is where the most recent events are.</p>
<pre><code class="language-bash">sudo journalctl -u tor -e
</code></pre>
<p>Unfortunately, the logs were as unhelpful as the status. They only confirmed that the service was starting and stopping, without providing any application-specific errors. This tells us the problem likely isn't with <code>systemd</code> itself, but with the Tor application.</p>
<h4>2. Check the Application Logs</h4>
<p>Most applications write their own, more detailed logs. For Tor, this is usually <code>/var/log/tor/notices.log</code>.</p>
<pre><code class="language-bash">sudo cat /var/log/tor/notices.log
</code></pre>
<p>The output here provides another huge clue: <strong><code>No such file or directory</code></strong>. A service that can't create its own log file is a strong sign of a <strong>file permissions problem</strong>. Even after trying to fix ownership with <code>chown</code>, the issue persisted, suggesting the problem was somewhere else.</p>
<h4>3. Inspect the Service File</h4>
<p>Sometimes the investigation leads to a surprising discovery. After reinstalling the <code>tor</code> package didn't help, the next place to look was the <code>systemd</code> service file itself.</p>
<pre><code class="language-bash">cat /lib/systemd/system/tor.service
</code></pre>
<p>Somehow, the file had been replaced with a generic placeholder. A critical line, <code>ExecStart=/bin/true</code>, was telling the service to run a command that does nothing and immediately exits successfully. After replacing the file's contents with the correct, default configuration, a real error message finally appeared.</p>
<h4>4. Verify the Configuration</h4>
<p>With the service file fixed, <code>systemctl restart tor</code> now failed with a proper error. This allows us to move on to verifying Tor's own configuration.</p>
<pre><code class="language-bash">sudo -u debian-tor tor --verify-config
</code></pre>
<p>This command passed, indicating that <code>/etc/tor/torrc</code> was syntactically correct. This is a classic troubleshooting moment: the config file is valid, but the service still won't run. The problem isn't the file's syntax, but <em>what the file is telling the service to do</em>.</p>
<h4>5. Run the Service Manually (The Breakthrough)</h4>
<p>This is often the final and most critical step. Bypassing <code>systemd</code> and running the Tor startup command directly, as the correct user, lets you see the live output.</p>
<pre><code class="language-bash">sudo -u debian-tor /usr/bin/tor --defaults-torrc /usr/share/tor/tor-service-defaults-torrc -f /etc/tor/torrc --RunAsDaemon 0
</code></pre>
<p>And there it was, in plain text:</p>
<blockquote>
<p><code>[warn] Failed to parse/validate config: Problem with User value. See logs for details.</code></p>
</blockquote>
<p>The <code>systemd</code> service was already starting the process as the <code>debian-tor</code> user, but a default Tor configuration file was <em>also</em> trying to switch to the <code>debian-tor</code> user. This redundant user-switching conflict caused the service to crash instantly.</p>
<p>The fix was to edit <code>/usr/share/tor/tor-service-defaults-torrc</code> and comment out the <code>User debian-tor</code> line. After that, the service started perfectly.</p>
<hr>
<h3>Lessons Learned</h3>
<p>This deep dive highlights a few core principles of system administration:</p>
<ul>
<li><strong>Trust the Process:</strong> Start broad (<code>systemctl status</code>) and get progressively more specific. Don't jump to conclusions.</li>
<li><strong>Permissions Are a Common Culprit:</strong> When in doubt, check file and directory ownership and permissions (<code>chown</code>, <code>chmod</code>).</li>
<li><strong>Find the Right Logs:</strong> If the main system log is unhelpful, find the application's own log file. If it doesn't exist, that itself is a clue.</li>
<li><strong>Run It Manually:</strong> If a service fails via <code>systemd</code>, run its startup command directly in the terminal. The live output is often the most valuable diagnostic information you can get.</li>
</ul>
<p>While the context was specific to a Tor service, this methodical approach of checking services, logs, permissions, and configurations—and finally running the process manually—is a playbook that can solve almost any &quot;service that won't start&quot; mystery.</p>

</article>
        </div>
    </main>

    <footer class="text-center py-6 bg-gray-950 text-gray-500">
    <div class="mb-2">
      <a href="https://blog.beaubremer.com/" target="_blank" class="hover:text-fuchsia-400 mx-2">Blog Home</a>
      <a href="https://github.com/KnowOneActual" target="_blank" class="hover:text-fuchsia-400 mx-2">GitHub</a>
     </div>
    <p>© 2025 Beau Bremer. Stay bold, keep creating, and rock on! All rights reserved.
    </p>
  </footer>
    <script src="/assets/js/lite-yt-embed.js"></script>
</body>
</html>